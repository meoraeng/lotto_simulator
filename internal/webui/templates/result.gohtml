<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <title>로또 시뮬레이터 - 결과</title>
    <link
        href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css"
        rel="stylesheet"
    >
    <style>
        body { background: #f5f7fb; }
        .page-header { margin-top: 32px; margin-bottom: 24px; }
        .lotto-badge { font-weight: 700; letter-spacing: 1px; }
        .lotto-ball {
            width: 32px; height: 32px; border-radius: 50%;
            display: inline-flex; align-items: center; justify-content: center;
            font-size: 14px; font-weight: 600; color: #fff;
        }
        .lotto-range-1 { background: #f94144; }
        .lotto-range-2 { background: #f8961e; }
        .lotto-range-3 { background: #f9c74f; color:#333; }
        .lotto-range-4 { background: #43aa8b; }
        .lotto-range-5 { background: #577590; }
        .section-title { font-weight: 600; margin-bottom: 8px; }
        .subtle-card { background: #ffffff; border-radius: 12px; }
    </style>
</head>
<body>
<div class="container my-4">
    <header class="page-header d-flex justify-content-between align-items-center">
        <div>
            <span class="badge bg-success lotto-badge">LOTTO RESULT</span>
            <h2 class="mt-2 mb-0 fw-bold">당첨 결과</h2>
            <p class="text-muted mb-0">
                입력한 당첨 번호와 발행된 로또 티켓을 기준으로 통계를 계산했습니다.
            </p>
        </div>
        <div class="text-end">
            <div class="text-muted small">
                모드:
                {{if eq .Mode 0}}고정 상금 모드{{else}}분배(패리뮤추얼) 모드{{end}}
            </div>
            <div class="text-muted small">
                총 구매 금액: <strong>{{money .TotalSales}}</strong>원
            </div>
        </div>
    </header>

    <div class="row">
        <div class="col-lg-5 mb-4">
            <div class="card subtle-card shadow-sm mb-3">
                <div class="card-body p-4">
                    <h5 class="section-title">당첨 번호</h5>
                    <div class="d-flex align-items-center flex-wrap gap-3">
                        <div class="d-flex flex-wrap gap-2 align-items-center">
                            {{range .WinningNumbers}}
                                <span class="lotto-ball" data-num="{{.}}">{{.}}</span>
                            {{end}}
                        </div>
                        <div class="d-flex align-items-center gap-2">
                            <span class="badge bg-secondary">보너스</span>
                            <span class="lotto-ball" data-num="{{.BonusNumber}}">
                                {{.BonusNumber}}
                            </span>
                        </div>
                    </div>
                </div>
            </div>

            {{if .PlayerSummaries}}
            <div class="card subtle-card shadow-sm mt-3">
                <div class="card-body p-4">
                    <h5 class="section-title">플레이어 요약</h5>
                    <p class="text-muted">
                        각 플레이어의 구매 금액, 티켓 수, 수령 금액, 수익률 요약입니다.
                    </p>

                    <ul class="list-group list-group-flush">
                        {{range .PlayerSummaries}}
                        <li class="list-group-item d-flex justify-content-between align-items-center">
                            <div>
                                <div class="fw-semibold">{{.Name}}</div>
                                <div class="small text-muted">
                                    구매 금액: {{money .Amount}}원 /
                                    티켓 수: {{.TicketCount}}장
                                </div>
                            </div>
                            <div class="text-end">
                                <div class="fw-semibold text-success">
                                    수령 금액: {{money .Earned}}원
                                </div>
                                <div class="small text-muted">
                                    수익률: {{printf "%.1f" .ProfitRate}}%
                                </div>
                            </div>
                        </li>
                        {{end}}
                    </ul>
                </div>
            </div>
            {{end}}

        </div>

        <div class="col-lg-7 mb-4">
            <div class="card subtle-card shadow-sm mb-3">
                <div class="card-body p-4">
                    <h5 class="section-title mb-3">당첨 통계</h5>

                    <table class="table align-middle mb-0">
                        <thead class="table-light">
                        <tr>
                            <th style="width: 20%">등수</th>
                            <th style="width: 40%">당첨 조건</th>
                            <th class="text-end" style="width: 20%">상금 (1장)</th>
                            <th class="text-end" style="width: 20%">당첨 개수</th>
                        </tr>
                        </thead>
                        <tbody>
                        {{range .RankRows}}
                        <tr>
                            <td>{{.RankLabel}}</td>
                            <td>{{.Condition}}</td>
                            <td class="text-end">{{money .Prize}}원</td>
                            <td class="text-end">{{.Count}}개</td>
                        </tr>
                        {{end}}
                        </tbody>
                    </table>
                </div>
            </div>

            <div class="card subtle-card shadow-sm">
                <div class="card-body p-4 d-flex justify-content-between align-items-center">
                    <div>
                        <div class="section-title mb-1">총 수익률</div>
                        <p class="text-muted mb-0">
                            총 구매 금액과 총 당첨 금액을 기준으로 계산한 수익률입니다.
                        </p>
                    </div>
                    <div class="text-end">
                        <div class="h4 mb-1">
                            {{printf "%.1f" .ProfitRate}}%
                        </div>
                        <div class="small text-muted">
                            총 당첨 금액: {{money .TotalPrize}}원
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div class="mt-4 d-flex justify-content-between">
        <a href="/" class="btn btn-outline-secondary">
            처음으로 돌아가기
        </a>
        <a href="/" class="btn btn-outline-primary">
            다시 시뮬레이션
        </a>
    </div>
</div>

<script
    src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js">
</script>
<script>
    document.addEventListener("DOMContentLoaded", function () {
        document.querySelectorAll(".lotto-ball").forEach(function (el) {
            var n = parseInt(el.dataset.num, 10);
            var cls = "lotto-range-1";
            if (n >= 1 && n <= 10) cls = "lotto-range-1";
            else if (n >= 11 && n <= 20) cls = "lotto-range-2";
            else if (n >= 21 && n <= 30) cls = "lotto-range-3";
            else if (n >= 31 && n <= 40) cls = "lotto-range-4";
            else if (n >= 41 && n <= 45) cls = "lotto-range-5";
            el.classList.add(cls);
        });
    });
</script>
</body>
</html>
