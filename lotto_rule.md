## 1. 기본 규칙(고정 상금 모드, 필수)

### R-1. 번호 규칙

1. 당첨 번호 추첨 시 **중복되지 않는 6개** + **보너스 1개**를 뽑는다.
    
2. 각 번호는 **1 이상 45 이하**여야 한다.
    
3. 티켓 1장은 **중복 없는 6개 번호**로 구성되며, 출력 시 **오름차순 정렬**한다.
    

### R-2. 등수 및 상금(정액)

- 당첨 기준 및 **정액 상금**은 다음과 같다.
    
    - **1등**: 6개 번호 일치 / **2,000,000,000원**
        
    - **2등**: 5개 번호 + 보너스 번호 일치 / **30,000,000원**
        
    - **3등**: 5개 번호 일치 / **1,500,000원**
        
    - **4등**: 4개 번호 일치 / **50,000원**
        
    - **5등**: 3개 번호 일치 / **5,000원**
        
    - 그 외: **(0원)**
        

### R-3. 발매(구매) 규칙

1. 로또 **1장의 가격은 1,000원**이다.
    
2. 사용자가 **구매 금액**을 입력하면, 해당 금액에 해당하는 **정수 개수의 티켓**을 발매한다.
    
3. 구매 금액은 **양의 정수이면서 1,000원으로 나누어떨어져야** 한다.
    
    - 위반 시 에러 처리(아래 R-6).

### R-4. 입력

1. **구매 금액**을 입력받는다.
    
2. **당첨 번호(6개)**를 입력받는다. 입력 형식은 자유이나, **6개 정수**여야 하며 **중복 불가**·**범위(1~45)** 검사를 통과해야 한다.
    
3. **보너스 번호(1개)**를 입력받는다. **1~45** 범위이며 **당첨 번호 6개와 중복 금지**.
    

### R-5. 출력

1. 발매된 **티켓 수**를 출력한다.
    
2. 발매된 **각 티켓의 번호(6개, 오름차순)**를 한 줄씩 출력한다.
    
3. **등수별 당첨 개수**를 출력한다. (1~5등 각 몇 장)
    
4. **총 수익률**을 출력한다.
    
    - 수익률 = `(총 당첨금 / 총 구매금액) * 100` (소수점 처리 방식은 구현에서 일관되게 결정)
        
    - 예: `기댓값 형태의 문자열` 또는 `소수점 N자리` 등, 형식은 일관성만 보장.
        

### R-6. 에러 처리와 재입력

- 입력이 잘못된 경우, **에러를 발생**시키고 다음을 수행한다.
    - **메시지 규칙**: `"[ERROR] 에러메시지"` 형식으로 출력한다.
    - **잘못된 해당 입력 단계부터 다시 입력**을 받는다.
- 에러 유형
    - 음수/0/비정수 입력
    - 1,000원 단위가 아닌 구매 금액
    - 번호 개수 부족/초과
    - 숫자 외 문자
    - 범위(1~45) 위반
    - 중복 번호 존재
    - 보너스 번호가 당첨 번호와 중복

### R-7. 비즈니스/입출력 분리(Go 추가사항)

- **입출력은 엔트리(main/cmd)에만 존재**하도록 한다.
    
- 번호 검증, 추첨, 판정, 수익률 계산 등 **핵심 로직은 별도 패키지(내부)**로 분리한다.
    
- 핵심 로직은 **단위 테스트**가 가능해야 한다(테이블 주도 테스트 활용)

---

## 2. 확장 규칙(패리뮤추얼 + 이월 + 상한/롤다운)

> 아래는 실제 복권 운영 규칙을 추가로 적용하여 학습하기 위한 추가 구현 내용이다.
> 기본 모드(R-1~R-7)를 유지하면서 추가 모드로 동작할 수 있게 설계한다.

### E-1. 모드 전환

- 프로그램은 **고정 상금 모드**와 **패리뮤추얼(분배) 모드**을 지원한다.
    
- 모드 선택은 **플래그/설정 파일**로 주입한다.
    

### E-2. 분배 설정(Allocation)

- 한 회차 총 판매액(Sales)에서 **등수별 할당 비율**을 설정(basis points 등).
    
- 예시: 1등 75%, 2등 12.5%, 3등 12.5% (합계 100%)
    

### E-3. 이월(Rollover)

- 특정 등수에서 **당첨자 수가 0**이면, 그 등수의 **풀 전액을 다음 회차로 이월**한다.
    
- 이월된 금액은 **다음 회차의 해당 등수 풀에 더해져** 분배된다.
    
### E-4. 상한(Cap) + 롤다운(Roll-down)

- 지정한 등수(보통 **1등**)의 **누적 풀 상한금액**을 설정한다.
    
- 분배 전, 해당 등수의 풀 금액이 상한을 초과하면 **초과분을 하위 등수로 롤다운**한다.
    
- 롤다운 분배 방식:
    
    - **균등 분배** 또는
        
    - **비례 분배**(하위 등수의 할당 비율에 비례)
        
- 롤다운 후에도 **하위 등수 당첨자 수가 0**이면 그 등수 풀은 **다음 회차로 이월**된다.
    

### E-5. 분배·라운딩

- 각 등수 **당첨자 수**가 w > 0이면, 해당 등수 풀을 **w로 균등 분배**한다.
    
- 분배는 **정수 금액 기준**으로 하며, **라운딩 규칙**(예: 100원 단위 절사)을 설정으로 지정한다.
    
- 라운딩으로 생긴 **잔액**은 **다음 회차 동일 등수로 이월**한다.
    

### E-6. 상태 유지

- 시스템은 **등수별 이월 잔액 상태**를 **회차 간 유지**해야 한다.

### E-7. 보고

- 한 회차 분배가 끝나면 다음을 표 형식으로 보고한다.
    
    - 회차 판매액, 등수별 풀(분배 전/후), 롤다운 금액, 당첨자 수, **인당 지급액**, 등수별 지급 총액, **잔액 이월**.
        

---

## 3. 품질

### Q-1. 테스트

- 핵심 로직(번호 검증/매칭/판정/수익률/분배)은 **테이블 주도 테스트**로 커버
    
- 경계값(1, 45), 중복/범위 위반, 2등(보너스) 케이스, 당첨자 0명, 상한 초과, 라운딩 잔액 등 **엣지 케이스**를 포함
    

### Q-2. 스타일 & 안정성

- `go fmt`, `go vet`를 통과
    

### Q-3. 에러 메시지

- 모든 사용자 입력 오류는 `"[ERROR] ..."` 로 시작한다.
    
- 내부 로직 오류(프로그램 버그)는 사용자에게 동일 포맷으로 노출하지 않고, **로깅**한다.


---



## 4. 입출력 

- **입력 흐름**
    
    1. 구매 금액 입력
        
    2. 당첨 번호 6개 입력(콤마 구분 등)
        
    3. 보너스 번호 1개 입력  
        (확장 모드일 경우) 분배 설정(파일) 로드
        
- **출력 항목**
    
    - 발매 티켓 수 및 각 티켓 번호
        
    - 등수별 당첨 개수
        
    - 총 당첨금, 총 구매금액, **수익률**
        
    - (확장 모드) 판매액, 등수별 풀/분배, 롤다운/이월 결과

## 5. 기능적 확장
- 외부 실제 회차 데이터 연동
    
- UI/웹 화면